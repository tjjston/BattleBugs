{% extends 'base.html' %}

{% block title %}User Profile - {{ user.username }}{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-8">
    <h2>{{ user.username }} <small class="text-muted">({{ user.email }})</small></h2>
    <p>Joined: {{ user.created_at.strftime('%Y-%m-%d') if user.created_at else 'Unknown' }}</p>

    <h4>Stats</h4>
    <ul>
      <li>Bugs submitted: {{ stats.bugs_submitted }}</li>
      <li>Total wins: {{ stats.total_wins }}</li>
      <li>Total losses: {{ stats.total_losses }}</li>
      <li>Win rate: {{ stats.win_rate }}%</li>
      <li>Comments made: {{ stats.comments_made }}</li>
      <li>Lore entries: {{ stats.lore_entries }}</li>
    </ul>

    <h4>Admin Actions</h4>
    <form method="post" action="{{ url_for('admin.update_user', user_id=user.id) }}">
      <div class="mb-3">
        <label class="form-label">Role</label>
        <select class="form-select" name="role">
          <option value="USER" {% if user.role=='USER' %}selected{% endif %}>USER</option>
          <option value="MODERATOR" {% if user.role=='MODERATOR' %}selected{% endif %}>MODERATOR</option>
          <option value="ADMIN" {% if user.role=='ADMIN' %}selected{% endif %}>ADMIN</option>
          <option value="OWNER" {% if user.role=='OWNER' %}selected{% endif %}>OWNER</option>
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">ELO</label>
        <input type="number" class="form-control" name="elo" value="{{ user.elo or 1000 }}">
      </div>

      <div class="form-check mb-3">
        <input class="form-check-input" type="checkbox" value="1" id="is_banned" name="is_banned" {% if user.is_banned %}checked{% endif %}>
        <label class="form-check-label" for="is_banned">Ban user</label>
      </div>

      <button class="btn btn-primary" type="submit">Save changes</button>
      <a class="btn btn-secondary" href="{{ url_for('admin.manage_users') }}">Back</a>
    </form>
  </div>
</div>

{% endblock %}
